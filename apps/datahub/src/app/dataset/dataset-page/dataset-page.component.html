@if ((facade.error$ | async) === null) {
<div class="bg-beige mb-9 sm:mb-16">
  @if ((facade.isPresent$ | async) === true) {

  <mel-datahub-dataset-header
    [record]="facade.metadata$ | async"
    [incomplete]="facade.isIncomplete$ | async"
  ></mel-datahub-dataset-header>

  }
</div>
<div class="">
  <div class="">
    @if ((displayMap$ | async) || (displayData$ | async)) {
    <!-- TODO: try to adapt tab layout to fit MEL -->
    <div class="mel-grid-container-dataset" style="height: 612px">
      <div
        class="sm:col-start-2 sm:col-span-8 pt-8 overflow-visible sm:pt-5"
        style="height: 512px"
      >
        <div
          class="text-[28px] text-title font-title transform sm:translate-y-10"
          translate
        >
          mel.record.metadata.preview
        </div>
        <mat-tab-group
          (selectedIndexChange)="onTabIndexChange($event)"
          [selectedIndex]="(displayMap$ | async) ? 0 : 1"
          animationDuration="200ms"
          mat-stretch-tabs="false"
          mat-align-tabs="start"
        >
          <mat-tab [disabled]="(displayMap$ | async) === false">
            <ng-template mat-tab-label>
              <span class="tab-header-label sm:ml-32" translate
                >mel.record.tab.map</span
              >
            </ng-template>
            @if(displayMap$ | async) {
            <div class="block" style="height: 500px">
              <gn-ui-map-view></gn-ui-map-view>
            </div>
            }
          </mat-tab>
          <mat-tab [disabled]="(displayData$ | async) === false">
            <ng-template mat-tab-label>
              <span class="tab-header-label" translate
                >mel.record.tab.data</span
              >
            </ng-template>
            @if(displayData$ | async) {
            <div class="block">
              <gn-ui-data-view mode="table"></gn-ui-data-view>
            </div>
            }
          </mat-tab>
          <mat-tab [disabled]="(displayData$ | async) === false">
            <ng-template mat-tab-label>
              <span class="tab-header-label" translate
                >mel.record.tab.chart</span
              >
            </ng-template>
            @if(displayData$ | async) {
            <div class="block">
              <gn-ui-data-view mode="chart"></gn-ui-data-view>
            </div>
            }
          </mat-tab>
        </mat-tab-group>
      </div>
    </div>
    } @if((selectedTabIndex$ | async) === 2) {
    <!-- TODO: create corresponding UI component or provide GN_UI_VERSION-->
    <gn-ui-data-view-share></gn-ui-data-view-share>
    } @if(displayDownload$ | async) {
    <div id="download" class="mel-grid-container-dataset mt-6">
      <div class="sm:col-start-2 sm:col-span-8">
        <!-- TODO: create corresponding components, uses GN-UI components for now -->
        <mel-datahub-dataset-downloads></mel-datahub-dataset-downloads>
      </div>
    </div>
    }
    <div class="lg:mx-auto">
      @if(displayApi$ | async) {
      <div id="api" class="block mt-6">
        <!-- TODO: create corresponding components, uses GN-UI components for now -->
        <mel-datahub-dataset-apis></mel-datahub-dataset-apis>
      </div>
      }
    </div>
    @if(displayRelated$ | async) {
    <!-- TODO: create corresponding UI component-->
    <div class="mel-grid-container-dataset">
      <div class="sm:col-start-2 sm:col-span-8">
        <div class="overflow-visible">
          <div>
            <p
              class="font-title text-[28px] text-title font-medium mt-6 sm:mt-10 mb-4 text-center sm:text-left"
              translate
            >
              mel.record.metadata.related
            </p>
            <div
              class="mb-4 flex flex-wrap gap-6 justify-center sm:justify-start"
            >
              @for(record of facade.related$ | async; track
              record.uniqueIdentifier){
              <gn-ui-related-record-card [record]="record">
              </gn-ui-related-record-card>
              }
            </div>
          </div>
        </div>
      </div>
    </div>
    }
  </div>
</div>
} @else {
<div class="mt-12 p-4 max-w-[600px] m-auto text-[13px]">
  @if((facade.error$ | async).notFound) {
  <gn-ui-search-results-error
    [type]="errorTypes.RECORD_NOT_FOUND"
    [recordId]="(facade.metadata$ | async).uniqueIdentifier"
  ></gn-ui-search-results-error>
  } @else if((facade.error$ | async).otherError) {}
  <gn-ui-search-results-error
    [type]="errorTypes.RECEIVED_ERROR"
    [error]="(facade.error$ | async).otherError"
  ></gn-ui-search-results-error>
</div>
}
